# ุชุญุฏูุซุงุช ุงูุฃูุงู - Pyramedia

ุชู ุฅุฌุฑุงุก ูุฌููุนุฉ ูู ุงูุชุญุณููุงุช ุงูุฃูููุฉ ุงููุงูุฉ ุนูู ุงููุดุฑูุน.

## ๐ ุงูุชุญุฏูุซุงุช ุงููููุฐุฉ

### โ 1. ููู ุจูุงูุงุช ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ุฅูู `.env`
- **ุงููุดููุฉ**: ูุงูุช ูููุฉ ุณุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุดููุฉ ูู ุงูููุฏ
- **ุงูุญู**:
  - ุฅูุดุงุก ููู `.env` ูุชุฎุฒูู ุงููุชุบูุฑุงุช ุงูุญุณุงุณุฉ
  - ุฅูุดุงุก `env.php` ููุฑุงุกุฉ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ
  - ุชุญุฏูุซ `db.php` ูุงุณุชุฎุฏุงู ุงููุชุบูุฑุงุช ูู `.env`
  - ุฅุถุงูุฉ `.env` ุฅูู `.gitignore`

**ุงูุชุนูููุงุช**:
1. ุงูุณุฎ `.env.example` ุฅูู `.env`
2. ุนุฏูู ุงูููู ูู `.env` ุญุณุจ ุจูุฆุฉ ุงูุฅูุชุงุฌ ุงูุฎุงุตุฉ ุจู
3. ุชุฃูุฏ ูู ุฃู `.env` ูุง ููุฑูุน ุฅูู Git

### โ 2. ุญุฐู ุนุฑุถ ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ
- **ุงููุดููุฉ**: ูุงูุช ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ุชุนุฑุถ username ูpassword ุงูุชุฑุงุถูุฉ
- **ุงูุญู**: ุชู ุญุฐู ูุฐุง ุงูุนุฑุถ ุจุงููุงูู ูู `admin/login.php`

**ุชุญุฐูุฑ**: ูููุตุญ ุจุดุฏุฉ ุจุชุบููุฑ ูููุฉ ุงููุฑูุฑ ุงูุงูุชุฑุงุถูุฉ ููุฑุงู!

### โ 3. ุฅุตูุงุญ ูููุฐุฌ ุงูุงุชุตุงู
- **ุงููุดููุฉ**: ูุงู ูููุฐุฌ ุงูุงุชุตุงู ูุง ูุญูุธ ุงูุจูุงูุงุช
- **ุงูุญู**:
  - ุฅุถุงูุฉ ุญูุธ ุงูุจูุงูุงุช ูู ุฌุฏูู `contact_messages`
  - ุฅุถุงูุฉ Validation ุดุงูู ูููุฏุฎูุงุช:
    - ุงูุชุญูู ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
    - ุชุญุฏูุฏ ุทูู ุงูุงุณู (max 100 ุญุฑู)
    - ุชุญุฏูุฏ ุทูู ุงูุฑุณุงูุฉ (max 2000 ุญุฑู)
  - ุญูุธ IP Address ู User Agent ูุฃุบุฑุงุถ ุฃูููุฉ
  - ุนุฑุถ ุฑุณุงุฆู ุฎุทุฃ ุชูุตูููุฉ
  - ุงูุญูุงุธ ุนูู ุจูุงูุงุช ุงููููุฐุฌ ุนูุฏ ุญุฏูุซ ุฎุทุฃ

### โ 4. ุฅุถุงูุฉ Rate Limiting
- **ุงููุดููุฉ**: ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ูุงูุช ุนุฑุถุฉ ููุฌูุงุช Brute Force
- **ุงูุญู**:
  - ุฅูุดุงุก ุฌุฏูู `login_attempts` ูุชุชุจุน ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู
  - ุฅุถุงูุฉ ุฏุงูุฉ `check_login_rate_limit()` ูู `auth.php`
  - ุงูุญุฏ ุงูุฃูุตู: 5 ูุญุงููุงุช ูุงุดูุฉ ุฎูุงู 15 ุฏูููุฉ
  - ุญุธุฑ ูุคูุช ููุฏุฉ 15 ุฏูููุฉ ุจุนุฏ ุชุฌุงูุฒ ุงูุญุฏ
  - ุนุฑุถ ุนุฏุฏ ุงููุญุงููุงุช ุงููุชุจููุฉ ูููุณุชุฎุฏู

**ุงูุฅุนุฏุงุฏุงุช** (ูู `.env`):
```
MAX_LOGIN_ATTEMPTS=5
LOGIN_LOCKOUT_DURATION=900
```

### โ 5. ุฅุถุงูุฉ Session Timeout
- **ุงููุดููุฉ**: ุงูุฌูุณุงุช ูุงูุช ุชุจูู ููุชูุญุฉ ุฅูู ุงูุฃุจุฏ
- **ุงูุญู**:
  - ุฅุถุงูุฉ ุฏุงูุฉ `check_session_timeout()` ูู `auth.php`
  - ุงูุชูุงุก ุงูุฌูุณุฉ ุชููุงุฆูุงู ุจุนุฏ 30 ุฏูููุฉ ูู ุนุฏู ุงููุดุงุท
  - ุชุณุฌูู ุญุฏุซ ุงูุชูุงุก ุงูุฌูุณุฉ ูู Activity Log
  - ุฅุนุงุฏุฉ ุงูุชูุฌูู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ูุน ุฑุณุงูุฉ ุชูุถูุญูุฉ

**ุงูุฅุนุฏุงุฏุงุช** (ูู `.env`):
```
ADMIN_SESSION_TIMEOUT=1800
```

### โ 6. ุงุณุชุฎุฏุงู HTTPS ุจุดูู ุฏููุงูููู
- **ุงููุดููุฉ**: ูุงู ุงูููุฏ ูุณุชุฎุฏู HTTP ุจุดูู ุซุงุจุช
- **ุงูุญู**:
  - ุงููุดู ุงูุชููุงุฆู ุนู ุงูุจุฑูุชูููู (HTTP/HTTPS)
  - ุงุณุชุฎุฏุงู ุงูุจุฑูุชูููู ุงูุตุญูุญ ูู ุงูุฑูุงุจุท ูุงูุตูุฑ

### โ๏ธ 7. ุชุญุณููุงุช ูู ุชูููุฐ ุจุงููุงูู (ุชุชุทูุจ ุนูู ูุฏูู)

#### Remember Me Token (ูู ููููุฐ ุจุงููุงูู)
- ุงูููุฏ ุงูุญุงูู ูุญูุธ Token ูู ุงูููููุฒ ููู ูุง ูุชุญูู ููู
- ุงูุญู ุงูููุชุฑุญ:
  1. ุญูุธ Token ูู ุฌุฏูู `remember_tokens`
  2. ุงูุชุญูู ูู Token ุนูุฏ ุฒูุงุฑุฉ ุงููููุน
  3. ุชุณุฌูู ุฏุฎูู ุชููุงุฆู ุฅุฐุง ูุงู Token ุตุญูุญ

## ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช

ุชุญุชุงุฌ ุฅูู ุชุดุบูู ููู SQL ูุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ:

```bash
mysql -u your_username -p your_database < security_updates.sql
```

ุฃู ูู ุฏุงุฎู phpMyAdminุ ุงุณุชูุฑุฏ ููู `security_updates.sql`

### ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ:
1. **login_attempts**: ูุชุชุจุน ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู
2. **remember_tokens**: ููุธุงู Remember Me ุงูุขูู

### ุงูุชุญุฏูุซุงุช ุนูู ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ:
1. **contact_messages**: ุฅุถุงูุฉ ุญููู `ip_address` ู `user_agent`
2. ุฅุถุงูุฉ Indexes ูุชุญุณูู ุงูุฃุฏุงุก

## ๐ ุชูุตูุงุช ุฃูููุฉ ุฅุถุงููุฉ

### ููุฑู (High Priority):
1. โ **ุชู**: ููู ูููุฉ ุณุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฅูู `.env`
2. โ **ุชู**: ุญุฐู ุนุฑุถ ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู
3. โ **ุชู**: ุฅุถุงูุฉ Rate Limiting
4. โ **ุชู**: ุฅุถุงูุฉ Session Timeout
5. โ **ุชู**: ุฅุถุงูุฉ Validation ูููุฏุฎูุงุช
6. โ๏ธ **ูุฏูู**: ุชุบููุฑ ูููุฉ ูุฑูุฑ ุงููุฏูุฑ ุงูุงูุชุฑุงุถูุฉ
7. โ๏ธ **ูุฏูู**: ุชูุนูู HTTPS ุนูู ุงูุณูุฑูุฑ

### ูุชูุณุท (Medium Priority):
8. โ๏ธ **ูุฏูู**: ุฅุถุงูุฉ ูุธุงู CAPTCHA ุจุนุฏ ูุญุงููุงุช ูุงุดูุฉ
9. โ๏ธ **ูุฏูู**: ุฅุถุงูุฉ Two-Factor Authentication (2FA)
10. โ๏ธ **ูุฏูู**: ุฅุถุงูุฉ ูุธุงู Upload ุขูู ููุตูุฑ
11. โ๏ธ **ูุฏูู**: ุฅุนุฏุงุฏ ูุธุงู Backup ุชููุงุฆู

### ููุฎูุถ (Low Priority):
12. โ๏ธ **ูุฏูู**: ุฅุถุงูุฉ Content Security Policy (CSP) Headers
13. โ๏ธ **ูุฏูู**: ุฅุถุงูุฉ ูุธุงู Logging ูุฑูุฒู
14. โ๏ธ **ูุฏูู**: ุฅุถุงูุฉ Tests (PHPUnit)

## ๐ ููุงุญุธุงุช ูููุฉ

### ููู `.env`
- ูุง ุชูุณ ูุณุฎ `.env.example` ุฅูู `.env` ูุชุนุฏูู ุงูููู
- ุชุฃูุฏ ูู ุฃู `.env` ูุญูู ููุง ูููู ุงููุตูู ุฅููู ูู ุงููุชุตูุญ
- ูู Apacheุ ุฃุถู ูุฐู ุงููุงุนุฏุฉ ุฅูู `.htaccess`:
```apache
<Files .env>
    Order allow,deny
    Deny from all
</Files>
```

### ูููุฉ ุงููุฑูุฑ ุงูุงูุชุฑุงุถูุฉ
ูููุตุญ ุจุดุฏุฉ ุจุชุบููุฑ ูููุฉ ุงููุฑูุฑ ุงูุงูุชุฑุงุถูุฉ ูููุฏูุฑ. ุงุณุชุฎุฏู ูุฐุง ุงูุณูุฑูุจุช:

```php
<?php
// change_password.php - ุงุญุฐู ูุฐุง ุงูููู ุจุนุฏ ุงูุงุณุชุฎุฏุงู!
require_once 'db.php';

$new_password = 'your_strong_password_here';
$hashed = password_hash($new_password, PASSWORD_BCRYPT);

db_update('admin_users',
    ['password' => $hashed],
    'username = :username',
    [':username' => 'admin']
);

echo "Password updated successfully!";
// ุงุญุฐู ูุฐุง ุงูููู ููุฑุงู ุจุนุฏ ุชุดุบููู!
?>
```

### ุงูุฃุฐููุงุช
ุชุฃูุฏ ูู ุฃู ุฃุฐููุงุช ุงููููุงุช ุตุญูุญุฉ:
```bash
chmod 600 .env
chmod 755 *.php
chmod 755 admin/*.php
```

## ๐ ุฅุตูุงุญ ุงููุดุงูู

### ุงููุดููุฉ: "Database connection failed"
- ุชุญูู ูู ุฃู `.env` ููุฌูุฏ ููุญุชูู ุนูู ุงูููู ุงูุตุญูุญุฉ
- ุชุญูู ูู ุฃู `env.php` ูุชู ุชุญูููู ูู `db.php`

### ุงููุดููุฉ: "Login attempts table not found"
- ูู ุจุชุดุบูู ููู `security_updates.sql`
- ุชุญูู ูู ุฅูุดุงุก ุฌุฏูู `login_attempts` ุจูุฌุงุญ

### ุงููุดููุฉ: "Session timeout not working"
- ุชุญูู ูู ุฃู `check_session_timeout()` ูุชู ุงุณุชุฏุนุงุคูุง ูู `require_admin_login()`
- ุชุญูู ูู ุฅุนุฏุงุฏุงุช `ADMIN_SESSION_TIMEOUT` ูู `.env`

## ๐ง ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงููุ ุชุญูู ูู:
1. ุณุฌู ุงูุฃุฎุทุงุก: `error_log` ูู ูุฌูุฏ ุงููุดุฑูุน
2. ุณุฌู PHP: ุนุงุฏุฉ ูู `/var/log/php/error.log`
3. ุณุฌู MySQL: ุชุญูู ูู ุงูุฃุฎุทุงุก ูู ุงุณุชุนูุงูุงุช SQL

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ**: 2025-10-30
**ุงูุฅุตุฏุงุฑ**: 1.0 - Security Improvements
